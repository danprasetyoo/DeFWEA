generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Calculator {
  id                  Int              @id @default(autoincrement())
  inputStatementDate  DateTime
  inputOpeningfund    String
  inputStatementPeriod DateTime
  inputTreatyYear     Int
  inputTreatyDetail   TreatyDetail[]
  inputLayerDetail    LayerDetail[]
  inputPremiumDetail  PremiumDetail[]
  inputShareDetail    ShareDetail[]    @relation("CalculatorToShareDetail")
}

model TreatyDetail {
  id                  Int              @id @default(autoincrement())
  formDataId          Int
  formData            Calculator       @relation(fields: [formDataId], references: [id], map: "custom_foreign_key")
  treatyCurrentYear   TreatyDetailCurrent? @relation("TreatyDetailToCurrent")
  treatyPriorYear     TreatyDetailPrior?   @relation("TreatyDetailToPrior")
  version             Int
}

model TreatyDetailCurrent {
  id                  Int             @id @default(autoincrement())
  currentExchange     Int
  currentMargin       Float
  currentBrokerage    Float
  currentInterest     Float
  currentLAP          Float
  currentMaintenance  Int
  treatyDetail        TreatyDetail    @relation("TreatyDetailToCurrent", fields: [treatyDetailId], references: [id])
  treatyDetailId      Int             @unique
}

model TreatyDetailPrior {
  id                  Int             @id @default(autoincrement())
  priorExchange       Int
  priorMargin         Float
  priorBrokerage      Float
  priorInterest       Float
  priorLAP            Float
  priorMaintenance    Int
  treatyDetail        TreatyDetail    @relation("TreatyDetailToPrior", fields: [treatyDetailId], references: [id])
  treatyDetailId      Int             @unique
}

model LayerDetail {
  id                  Int              @id @default(autoincrement())
  formDataId          Int
  formData            Calculator       @relation(fields: [formDataId], references: [id])
  pdmaLayerId         Int              @unique
  pdmaLayer           PdmaDetailLayer  @relation(fields: [pdmaLayerId], references: [id])
  maLayerId           Int              @unique
  maLayer             MaDetailLayer    @relation(fields: [maLayerId], references: [id])
  avLayerId           Int              @unique
  avLayer             AvDetailLayer    @relation(fields: [avLayerId], references: [id])
  liabilityLayerId    Int              @unique
  liabilityLayer      LiabilityDetailLayer @relation(fields: [liabilityLayerId], references: [id])
  version             Int
}

model PdmaDetailLayer {
  id                  Int                   @id @default(autoincrement())
  pdmaDetailUsd       Int
  pdmaDetailIdr       Int
  pdmaDetailShare     Float
  layerDetail         LayerDetail? 
  layerDetailId       Int                
}

model MaDetailLayer {
  id                  Int                   @id @default(autoincrement())
  maDetailUsd         Int
  maDetailIdr         Int
  maDetailShare       Float
  layerDetail         LayerDetail?
  layerDetailId       Int                 
}

model AvDetailLayer {
  id                  Int                   @id @default(autoincrement())
  avDetailUsd         Int
  avDetailIdr         Int
  avDetailShare       Float
  layerDetail         LayerDetail?    
  layerDetailId       Int       
}

model LiabilityDetailLayer {
  id                  Int                   @id @default(autoincrement())
  liabilityDetailUsd  Int
  liabilityDetailIdr  Int
  liabilityDetailShare Float
  layerDetail         LayerDetail?
  layerDetailId       Int       
}

model PremiumDetail {
  id                  Int              @id @default(autoincrement())
  formDataId          Int
  formData            Calculator       @relation(fields: [formDataId], references: [id])
  pdmaPremiumId       Int              @unique  
  pdmaPremium         PdmaDetailPremium @relation(fields: [pdmaPremiumId], references: [id])
  maPremiumId         Int              @unique  
  maPremium           MaDetailPremium   @relation(fields: [maPremiumId], references: [id])
  avPremiumId         Int              @unique  
  avPremium           AvDetailPremium   @relation(fields: [avPremiumId], references: [id])
  liabilityPremiumId  Int              @unique 
  liabilityPremium    LiabilityDetailPremium  @relation(fields: [liabilityPremiumId], references: [id])
  version             Int
}

model PdmaDetailPremium {
  id                  Int               @id @default(autoincrement())
  pdmaPremiumUsd      Int
  pdmaPremiumIdr      Int
  pdmaPremiumShare    Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model MaDetailPremium {
  id                  Int               @id @default(autoincrement())
  maPremiumUsd        Int
  maPremiumIdr        Int
  maPremiumShare      Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model AvDetailPremium {
  id                  Int               @id @default(autoincrement())
  avPremiumUsd        Int
  avPremiumIdr        Int
  avPremiumShare      Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model LiabilityDetailPremium {
  id                  Int               @id @default(autoincrement())
  liabilityPremiumUsd Int
  liabilityPremiumIdr Int
  liabilityPremiumShare Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model ShareDetail {
  id                        Int                     @id @default(autoincrement())
  pdmaShareId               Int                     @unique  
  pdmaShare                 PdmaDetailShare         @relation(fields: [pdmaShareId], references: [id])
  maShareId                 Int                     @unique  
  maShare                   MaDetailShare           @relation(fields: [maShareId], references: [id])
  avShareId                 Int                     @unique  
  avShare                   AvDetailShare           @relation(fields: [avShareId], references: [id])
  liabilityShareId          Int                     @unique  
  liabilityShare            LiabilityDetailShare    @relation(fields: [liabilityShareId], references: [id])
  version                   Int
  calculatorId              Int
  calculator                Calculator              @relation("CalculatorToShareDetail", fields: [calculatorId], references: [id])
}

model PdmaDetailShare {
  id                  Int                   @id @default(autoincrement())
  pdmaShareUsd        Int
  pdmaShareIdr        Int
  pdmaSharePremiumUsd Int
  pdmaSharePremiumIdr Int
  shareDetail         ShareDetail?
  shareDetailId       Int      
}

model MaDetailShare {
  id                  Int                   @id @default(autoincrement())
  maShareUsd          Int
  maShareIdr          Int
  maSharePremiumUsd   Int
  maSharePremiumIdr   Int
  shareDetail         ShareDetail?   
  shareDetailId       Int      
}

model AvDetailShare {
  id                  Int                   @id @default(autoincrement())
  avShareUsd          Int
  avShareIdr          Int
  avSharePremiumUsd   Int
  avSharePremiumIdr   Int
  shareDetail         ShareDetail?
  shareDetailId       Int      
}

model LiabilityDetailShare {
  id                        Int              @id @default(autoincrement())
  liabilityShareUsd         Int
  liabilityShareIdr         Int
  liabilitySharePremiumUsd  Int
  liabilitySharePremiumIdr  Int
  shareDetail               ShareDetail?
  shareDetailId             Int      
}
