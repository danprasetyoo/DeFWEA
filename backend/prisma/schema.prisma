generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Calculator {
  id                  Int              @id @default(autoincrement())
  inputStatementDate  DateTime
  inputOpeningfund    String
  inputStatementPeriod DateTime
  inputTreatyYear     Int
  inputTreatyDetail   TreatyDetail[]
  inputLayerDetail    LayerDetail[]
  inputPremiumDetail  PremiumDetail[]
  inputShareDetail    ShareDetail[]    @relation("CalculatorToShareDetail")
}

model TreatyDetail {
  id                  Int              @id @default(autoincrement())
  formDataId          Int
  formData            Calculator       @relation(fields: [formDataId], references: [id], map: "custom_foreign_key")
  treatyCurrentYear   treatyDetailCurrent? @relation("TreatyDetailToCurrent")
  treatyPriorYear     treatyDetailPrior?   @relation("TreatyDetailToPrior")
  version             Int
}

model treatyDetailCurrent {
  id                  Int             @id @default(autoincrement())
  currentExchange     Int
  currentMargin       Float
  currentBrokerage    Float
  currentInterest     Float
  currentLAP          Float
  currentMaintenance  Float
  treatyDetail        TreatyDetail    @relation("TreatyDetailToCurrent", fields: [treatyDetailId], references: [id])
  treatyDetailId      Int             @unique
}

model treatyDetailPrior {
  id                  Int             @id @default(autoincrement())
  priorExchange       Int
  priorMargin         Float
  priorBrokerage      Float
  priorInterest       Float
  priorLAP            Float
  priorMaintenance    Float
  treatyDetail        TreatyDetail    @relation("TreatyDetailToPrior", fields: [treatyDetailId], references: [id])
  treatyDetailId      Int             @unique
}

model LayerDetail {
  id                  Int              @id @default(autoincrement())
  formDataId          Int
  formData            Calculator       @relation(fields: [formDataId], references: [id])
  pdmaLayerId         Int              @unique 
  pdmaLayer           pdmaDetailLayer  @relation(fields: [pdmaLayerId], references: [id])
  maLayerId           Int              @unique  
  maLayer             maDetailLayer    @relation(fields: [maLayerId], references: [id])
  avLayerId           Int              @unique  
  avLayer             avDetailLayer    @relation(fields: [avLayerId], references: [id])
  liabilityLayerId    Int              @unique 
  liabilityLayer      liabilityDetailLayer @relation(fields: [liabilityLayerId], references: [id])
  version             Int
}

model pdmaDetailLayer {
  id                  Int                   @id @default(autoincrement())
  pdmaDetailUsd       Int
  pdmaDetailIdr       Int
  pdmaDetailShare     Float
  layerDetail         LayerDetail? 
  layerDetailId       Int                
}

model maDetailLayer {
  id                  Int                   @id @default(autoincrement())
  maDetailUsd         Int
  maDetailIdr         Int
  maDetailShare       Float
  layerDetail         LayerDetail?
  layerDetailId       Int                 
}

model avDetailLayer {
  id                  Int                   @id @default(autoincrement())
  avDetailUsd         Int
  avDetailIdr         Int
  avDetailShare       Float
  layerDetail         LayerDetail?    
  layerDetailId       Int       
}

model liabilityDetailLayer {
  id                  Int                   @id @default(autoincrement())
  liabilityDetailUsd  Int
  liabilityDetailIdr  Int
  liabilityDetailShare Float
  layerDetail         LayerDetail?
  layerDetailId       Int       
}

model PremiumDetail {
  id                  Int              @id @default(autoincrement())
  formDataId          Int
  formData            Calculator       @relation(fields: [formDataId], references: [id])
  pdmaPremiumId       Int              @unique  
  pdmaPremium         pdmaDetailPremium @relation(fields: [pdmaPremiumId], references: [id])
  maPremiumId         Int              @unique  
  maPremium           maDetailPremium   @relation(fields: [maPremiumId], references: [id])
  avPremiumId         Int              @unique  
  avPremium           avDetailPremium   @relation(fields: [avPremiumId], references: [id])
  liabilityPremiumId  Int              @unique 
  liabilityPremium    liabilityDetailPremium  @relation(fields: [liabilityPremiumId], references: [id])
  version             Int
}

model pdmaDetailPremium {
  id                  Int               @id @default(autoincrement())
  pdmaPremiumUsd      Int
  pdmaPremiumIdr      Int
  pdmaPremiumShare    Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model maDetailPremium {
  id                  Int               @id @default(autoincrement())
  maPremiumUsd        Int
  maPremiumIdr        Int
  maPremiumShare      Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model avDetailPremium {
  id                  Int               @id @default(autoincrement())
  avPremiumUsd        Int
  avPremiumIdr        Int
  avPremiumShare      Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model liabilityDetailPremium {
  id                  Int               @id @default(autoincrement())
  liabilityPremiumUsd Int
  liabilityPremiumIdr Int
  liabilityPremiumShare Float
  premiumDetail       PremiumDetail?    
  premiumDetailId     Int?
}

model ShareDetail {
  id                        Int                     @id @default(autoincrement())
  pdmaShareId               Int                     @unique  
  pdmaShare                 pdmaDetailShare         @relation(fields: [pdmaShareId], references: [id])
  maShareId                 Int                     @unique  
  maShare                   maDetailShare           @relation(fields: [maShareId], references: [id])
  avShareId                 Int                     @unique  
  avShare                   avDetailShare           @relation(fields: [avShareId], references: [id])
  liabilityShareId          Int                     @unique  
  liabilityShare            liabilityDetailShare    @relation(fields: [liabilityShareId], references: [id])
  version                   Int
  calculatorId              Int
  calculator                Calculator              @relation("CalculatorToShareDetail", fields: [calculatorId], references: [id])
}

model pdmaDetailShare {
  id                  Int                   @id @default(autoincrement())
  pdmaShareUsd        Int
  pdmaShareIdr        Int
  pdmaSharePremiumUsd Int
  pdmaSharePremiumIdr Int
  shareDetail         ShareDetail?
  shareDetailId       Int      
}

model maDetailShare {
  id                  Int                   @id @default(autoincrement())
  maShareUsd          Int
  maShareIdr          Int
  maSharePremiumUsd   Int
  maSharePremiumIdr   Int
  shareDetail         ShareDetail?   
  shareDetailId       Int      
       
}

model avDetailShare {
  id                  Int                   @id @default(autoincrement())
  avShareUsd          Int
  avShareIdr          Int
  avSharePremiumUsd   Int
  avSharePremiumIdr   Int
  shareDetail         ShareDetail?
  shareDetailId       Int      
         
}

model liabilityDetailShare {
  id                        Int              @id @default(autoincrement())
  liabilityShareUsd         Int
  liabilityShareIdr         Int
  liabilitySharePremiumUsd  Int
  liabilitySharePremiumIdr  Int
  shareDetail               ShareDetail?
  shareDetailId             Int      
}
